[
  {
    "objectID": "pages/merfish.html",
    "href": "pages/merfish.html",
    "title": "\n3  MERFISH\n",
    "section": "",
    "text": "library(dplyr)\nlibrary(ggplot2)\nlibrary(patchwork)\nlibrary(ggnewscale)\nlibrary(SpatialData)\nlibrary(SpatialData.data)\nlibrary(SpatialData.plot)\n##  Warning: replacing previous import 'SpatialData::layer' by 'ggplot2::layer'\n##  when loading 'SpatialData.plot'\nlibrary(SingleCellExperiment)\n##  Warning: package 'SingleCellExperiment' was built under R version 4.4.2\n##  Warning: package 'IRanges' was built under R version 4.4.2\n##  Warning: package 'GenomeInfoDb' was built under R version 4.4.2\n\n\ndir.create(td &lt;- tempfile())\nzs &lt;- unzip_spd_demo(\n    zipname=\"merfish\", \n    source=\"biocOSN\",\n    destination=td)\n##  returning path to cached zip\n(sd &lt;- readSpatialData(zs))\n##  class: SpatialData\n##  - images(1):\n##    - rasterized (1,522,575)\n##  - labels(0):\n##  - points(1):\n##    - single_molecule (3714642)\n##  - shapes(2):\n##    - anatomical (6,polygon)\n##    - cells (2389,circle)\n##  - tables(1):\n##    - table (268,2389)\n##  coordinate systems:\n##  - global(4): rasterized anatomical cells single_molecule\n\n\np &lt;- point(sd, \"single_molecule\")\np &lt;- p[sample(length(p), 2e3)]\npoint(sd, \"molecules\") &lt;- p\nplotSpatialData() +\n    plotImage(sd) +\n    new_scale_color() +\n    plotShape(sd, \"anatomical\") +\n    new_scale_color() +\n    plotPoint(sd, \"molecules\", c=\"cell_type\", s=0.1)\n##  Scale for y is already present.\n##  Adding another scale for y, which will replace the existing scale.\n##  Warning: Removed 1 row containing missing values or values outside the scale range\n##  (`geom_point()`).\n\n\n\n\n\n\n\n\n\n\n\n\n\nSession\n\n\n\n\n\n\nsessionInfo()\n##  R version 4.4.1 Patched (2024-07-08 r86893)\n##  Platform: aarch64-apple-darwin20\n##  Running under: macOS Sonoma 14.2.1\n##  \n##  Matrix products: default\n##  BLAS:   /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRblas.0.dylib \n##  LAPACK: /Library/Frameworks/R.framework/Versions/4.4-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.12.0\n##  \n##  locale:\n##  [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n##  \n##  time zone: Europe/Berlin\n##  tzcode source: internal\n##  \n##  attached base packages:\n##  [1] stats4    stats     graphics  grDevices utils     datasets  methods  \n##  [8] base     \n##  \n##  other attached packages:\n##   [1] SingleCellExperiment_1.28.1 SummarizedExperiment_1.36.0\n##   [3] Biobase_2.66.0              GenomicRanges_1.58.0       \n##   [5] GenomeInfoDb_1.42.1         IRanges_2.40.1             \n##   [7] S4Vectors_0.44.0            BiocGenerics_0.52.0        \n##   [9] MatrixGenerics_1.18.0       matrixStats_1.4.1          \n##  [11] SpatialData.plot_0.99.3     SpatialData.data_0.99.0    \n##  [13] SpatialData_0.99.21         ggnewscale_0.5.0           \n##  [15] patchwork_1.3.0             ggplot2_3.5.1              \n##  [17] dplyr_1.1.4                \n##  \n##  loaded via a namespace (and not attached):\n##   [1] DBI_1.2.3               RBGL_1.82.0             rlang_1.1.4            \n##   [4] magrittr_2.0.3          Rarr_1.6.0              e1071_1.7-16           \n##   [7] compiler_4.4.1          RSQLite_2.3.9           dir.expiry_1.14.0      \n##  [10] paws.storage_0.7.0      png_0.1-8               vctrs_0.6.5            \n##  [13] stringr_1.5.1           pkgconfig_2.0.3         wk_0.9.4               \n##  [16] crayon_1.5.3            fastmap_1.2.0           dbplyr_2.5.0           \n##  [19] XVector_0.46.0          labeling_0.4.3          paws.common_0.7.7      \n##  [22] utf8_1.2.4              rmarkdown_2.29          graph_1.84.0           \n##  [25] UCSC.utils_1.2.0        purrr_1.0.2             bit_4.5.0.1            \n##  [28] xfun_0.49               zlibbioc_1.52.0         cachem_1.1.0           \n##  [31] jsonlite_1.8.9          blob_1.2.4              DelayedArray_0.32.0    \n##  [34] tweenr_2.0.3            parallel_4.4.1          R6_2.5.1               \n##  [37] stringi_1.8.4           reticulate_1.40.0       Rcpp_1.0.13-1          \n##  [40] assertthat_0.2.1        knitr_1.49              R.utils_2.12.3         \n##  [43] Matrix_1.7-1            tidyselect_1.2.1        rstudioapi_0.17.1      \n##  [46] abind_1.4-8             yaml_2.3.10             zellkonverter_1.16.0   \n##  [49] curl_6.0.1              lattice_0.22-6          tibble_3.2.1           \n##  [52] basilisk.utils_1.18.0   withr_3.0.2             evaluate_1.0.1         \n##  [55] sf_1.0-19               polyclip_1.10-7         units_0.8-5            \n##  [58] proxy_0.4-27            BiocFileCache_2.14.0    pillar_1.9.0           \n##  [61] filelock_1.0.3          KernSmooth_2.23-24      generics_0.1.3         \n##  [64] nanoarrow_0.6.0         munsell_0.5.1           scales_1.3.0           \n##  [67] class_7.3-22            glue_1.8.0              tools_4.4.1            \n##  [70] grid_4.4.1              colorspace_2.1-1        GenomeInfoDbData_1.2.13\n##  [73] basilisk_1.18.0         ggforce_0.4.2           cli_3.6.3              \n##  [76] fansi_1.0.6             S4Arrays_1.6.0          arrow_18.1.0           \n##  [79] geoarrow_0.2.1          gtable_0.3.6            R.methodsS3_1.8.2      \n##  [82] digest_0.6.37           classInt_0.4-10         SparseArray_1.6.0      \n##  [85] htmlwidgets_1.6.4       farver_2.1.2            memoise_2.0.1          \n##  [88] htmltools_0.5.8.1       R.oo_1.27.0             lifecycle_1.0.4        \n##  [91] httr_1.4.7              bit64_4.5.2             MASS_7.3-61\n\n\n\n\n\n\n\n Back to top",
    "crumbs": [
      "Workflows",
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>MERFISH</span>"
    ]
  }
]